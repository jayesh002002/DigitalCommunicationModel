clear all;close all;%----------------------------------------------------%---------------- Initial Parameters ----------------%----------------------------------------------------n = 128;     %number of bitsM = 4;        %4-QAMk = log2(M);  %number of bits in one symbolm = n/k; %number of symbolsif mod(n, k) ~= 0    error('numberOfBits must be a multiple of log2(M).');endnumSamplesPerSymbol = 1;    % Oversampling factorFc_tx = 3*10^6;    %carrier frequency : 3MHzphase_tx = 0;     %carrier phaseFs = Fc_tx * 2.1;t = (0:m-1)/Fs;%----------------------------------------------------%----------------Creation of the bitstream ----------%----------------------------------------------------dataIn = randi(2,n,1) - 1  % Generate vector of binary data%----------------------------------------------------%----------------- QAM Mapper -----------------------%----------------------------------------------------numberOfSymbols = length(dataIn)/k; %number of symbols in the FIFO% Define mapping table applying Gray mappingmappingTable(1) =  1 + 1*i;mappingTable(2) = -1 + 1*i;mappingTable(3) =  1 - 1*i;mappingTable(4) = -1 - 1*i;mappedSymbols = zeros(1, numberOfSymbols);% Map bits to symbolsfor i = 1:k:length(dataIn)     symbolBits = dataIn(i:i+k-1);  symbolIndex = 2^1 * symbolBits(1) + 2^0 * symbolBits(2);     % Mapping   mappedSymbols((i - 1)/k + 1) = mappingTable( symbolIndex + 1);   endfor%----------------------------------------------------%----------------- Modulation: Baseband to RF -------%----------------------------------------------------Tx_I = real(mappedSymbols) .* (sqrt(2)*cos(2*pi*Fc_tx*t+phase_tx));Tx_Q = imag(mappedSymbols) .* (sqrt(2)*sin(2*pi*Fc_tx*t+phase_tx));Tx = Tx_I - Tx_Q;%----------------------------------------------------%----------------- Figures --------------------------%----------------------------------------------------##figure(1);##stem(dataIn,"filled");##title('Data In');##xlabel('Bit Index');##ylabel('Binary Value');##figure(2);##subplot(2,1,1);##stem(real(mappedSymbols));##title("Real part")##subplot(2,1,2);##stem(imag(mappedSymbols));##title("Imaginary part");##figure(3);##scatter(real(mappedSymbols), imag(mappedSymbols) , "filled");##axis([-2 2 -2 2]);##title("Symbols");figure(4);plot(Tx_I);