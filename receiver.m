%----------------------------------------------------%----------------- Demodulator ----------------------%----------------------------------------------------Rx_I = Rx .* (sqrt(2)*cos(2*pi*Fc_tx*t+phase_tx));Rx_Q = Rx .* (-sqrt(2)*sin(2*pi*Fc_tx*t+phase_tx))%----------------------------------------------------%----------------- QAM Demapper ---------------------%----------------------------------------------------receivedSymbols = Rx;% Map symbols to bitsfor i = 1:length(receivedSymbols)       [diff receivedSymbolsIndex(i)] = min( receivedSymbols(i) - mappingTable) ; endforreceivedSymbolsIndex = receivedSymbolsIndex - 1;dataOut = zeros(24, 1);  for i = 1:length(receivedSymbols)        dataOut(i*2 - 1)  = rem(floor(receivedSymbolsIndex(i)/2), 2);    dataOut(i*2)      = rem(receivedSymbolsIndex(i), 2);endfor%----------------------------------------------------%----------------- Bit Error Rate -------------------%----------------------------------------------------BER = 0;for i = 1:length(dataIn)        if dataIn(i) != dataOut(i)       BER++;    endifendfor%----------------------------------------------------%----------------- Figures --------------------------%----------------------------------------------------figure(13);plot(Rx_I);##figure(11)##scatter(real(receivedSymbols), imag(receivedSymbols) , "filled");##axis([-2 2 -2 2])##title("Received Symbols")##figure(12)##stem(dataOut,"filled");##title('Data Out');##xlabel('Bit Index');##ylabel('Binary Value');